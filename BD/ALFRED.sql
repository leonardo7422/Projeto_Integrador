
DROP database if exists ALFRED;

CREATE DATABASE if not exists ALFRED;



USE ALFRED;


Create table usuarios (
ID Int UNSIGNED ZEROFILL NOT NULL AUTO_INCREMENT,
login Varchar(30),
senha Varchar(40),
Primary Key (ID)) ENGINE = MyISAM;

CREATE TABLE IF NOT EXISTS USUARIO (
    ID_USUARIO INT NOT NULL PRIMARY KEY,
    CEP VARCHAR(9),
    ACESSO enum('ADM', 'USU'),
    EMAIL VARCHAR(50),
    NOME_USUARIO VARCHAR(50)
);

CREATE TABLE IF NOT EXISTS ATOR (
    ID_ATOR INT NOT NULL PRIMARY KEY,
    NOME_ATOR VARCHAR(50)
);

CREATE TABLE IF NOT EXISTS DIRETOR (
    ID_DIRETOR INT NOT NULL PRIMARY KEY,
    NOME_DIRETOR VARCHAR(50)
);

CREATE TABLE IF NOT EXISTS GENERO (
    ID_GENERO INT NOT NULL PRIMARY KEY,
    DESCRICAO_GENERO VARCHAR(50)
);

CREATE TABLE IF NOT EXISTS FILME (
    ID_FILME INT NOT NULL PRIMARY KEY,
    ID_ATOR INT NOT NULL,
    ID_DIRETOR INT NOT NULL,
    ID_GENERO INT NOT NULL,
    TITULO VARCHAR(50),
    SINOPSE VARCHAR(300),
    FICHA_TECNICA VARCHAR(100),
    DATA_ESTREIA DATE,
    DATA_RETIRADA DATE,
    FOREIGN KEY (ID_ATOR)
        REFERENCES ATOR (ID_ATOR)
        ON UPDATE CASCADE ON DELETE CASCADE,
    FOREIGN KEY (ID_DIRETOR)
        REFERENCES DIRETOR (ID_DIRETOR)
        ON UPDATE CASCADE ON DELETE CASCADE,
    FOREIGN KEY (ID_GENERO)
        REFERENCES GENERO (ID_GENERO)
        ON UPDATE CASCADE ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS GENERO_FILME (
    ID_FILME INT NOT NULL,
    ID_GENERO INT NOT NULL,
    PRIMARY KEY (ID_FILME , ID_GENERO),
    FOREIGN KEY (ID_FILME)
        REFERENCES FILME (ID_FILME)
        ON UPDATE CASCADE ON DELETE CASCADE,
    FOREIGN KEY (ID_GENERO)
        REFERENCES GENERO (ID_GENERO)
        ON UPDATE CASCADE ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS LISTA_DESEJO (
    ID_FILME INT NOT NULL,
    ID_USUARIO INT NOT NULL,
    PRIMARY KEY (ID_FILME , ID_USUARIO),
    FOREIGN KEY (ID_USUARIO)
        REFERENCES USUARIO (ID_USUARIO)
        ON UPDATE CASCADE ON DELETE CASCADE,
    FOREIGN KEY (ID_FILME)
        REFERENCES FILME (ID_FILME)
        ON UPDATE CASCADE ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS HISTORICO (
    ID_USUARIO INT NOT NULL,
    ID_FILME INT NOT NULL,
    PRIMARY KEY(ID_USUARIO, ID_FILME),
    FOREIGN KEY (ID_USUARIO)
        REFERENCES USUARIO (ID_USUARIO)
        ON UPDATE CASCADE ON DELETE CASCADE,
    FOREIGN KEY (ID_FILME)
        REFERENCES FILME (ID_FILME)
        ON UPDATE CASCADE ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS AVALIACAO_FILME (
    ID_USUARIO INT NOT NULL,
    COMENTARIO VARCHAR(50),
    ID_FILME INT NOT NULL,
    NOTA INT,
    DATA INT,
      FOREIGN KEY (ID_FILME)
        REFERENCES HISTORICO (ID_FILME)
        ON UPDATE CASCADE ON DELETE CASCADE
);


CREATE TABLE IF NOT EXISTS CLASSIFICACAO (
    ID_CLASSIFICACAO INT NOT NULL PRIMARY KEY,
    CLASSIFICACAO_INDICATIVA VARCHAR(10),
    ID_FILME INT NOT NULL,
     FOREIGN KEY (ID_FILME)
        REFERENCES FILME (ID_FILME)
        ON UPDATE CASCADE ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS CIDADE (
    ID_CIDADE INT NOT NULL PRIMARY KEY,
    NOME_CIDADE VARCHAR(50)
);

CREATE TABLE IF NOT EXISTS CINEMA (
    ID_CINEMA INT NOT NULL PRIMARY KEY,
    NOME_CINEMA VARCHAR(50),
    ID_CIDADE INT NOT NULL,
    FOREIGN KEY (ID_CIDADE)
        REFERENCES CIDADE (ID_CIDADE)
        ON UPDATE CASCADE ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS SESSAO (
    ID_SESSAO INT NOT NULL PRIMARY KEY,
    SITE_COMPRA VARCHAR(100),
    HORARIO TIME,
    ID_CINEMA INT NOT NULL,
    FOREIGN KEY (ID_CINEMA)
        REFERENCES CINEMA (ID_CINEMA)
        ON UPDATE CASCADE ON DELETE CASCADE
);




INSERT INTO USUARIO VALUES (1, '14809-300', 'ADM', 'leo@hotmail.com', 'Leonardo');
INSERT INTO USUARIO VALUES (2, '14803-200', 'USU', 'naty@hotmail.com', 'Natielly');
INSERT INTO USUARIO VALUES (3, '14801-132', 'USU', 'maria@hotmail.com', 'Maria');

INSERT INTO ATOR VALUES (4, 'Ryan Gosling');
INSERT INTO ATOR VALUES(5, 'Zac Efron');
INSERT INTO ATOR VALUES (6, 'Joaquin Phoenix');

INSERT INTO DIRETOR VALUES (7, 'James Gunn');
INSERT INTO DIRETOR VALUES (8, 'Quentin Tarantino');
INSERT INTO DIRETOR VALUES (9, 'Todd Phillips');


INSERT INTO GENERO VALUES (10, 'Acão');
INSERT INTO GENERO VALUES (20, 'Aventura');
INSERT INTO GENERO VALUES (30, 'Comédia');

INSERT INTO FILME VALUES (100, 4, 7, 10, 'Django Livre','No sul dos Estados Unidos, anos antes da Guerra Civil, um ex-escravo Django faz uma aliança inesperada com o caçador de recompensas Schultz para caçar os criminosos mais procurados do país e resgatar sua esposa de um fazendeiro que força seus escravos a participarem de competições mortais.',
 'Ano: 2019, Duração: 180 minutos', '2019-10-01', '2019-11-01');
INSERT INTO FILME VALUES (200, 6, 9, 30, 'Coringa', 'O comediante falido Arthur Fleck encontra violentos bandidos pelas ruas de Gotham City. Desconsiderado pela sociedade, Fleck começa a ficar louco e se transforma no criminoso conhecido como Coringa.',
 'Ano: 2019, Duração: 120 minutos', '2019-08-03', '2019-10-01');
INSERT INTO FILME VALUES (300, 5, 8, 20, 'Resident Evil', 'Alice e Rain Ocampo têm a missão de destruir um laboratório genético operado pela poderosa corporação Umbrella, um dos maiores conglomerados do mundo, onde um vírus foi disseminado, matando seu criador e ressurgindo como uma criatura demoníaca, que sente uma fome incontrolável e transforma todas as suas vítimas em zumbis. O time tem apenas três horas para evitar que o vírus invada a Terra.',
 'Ano: 2002, Duração: 500 minutos', '2010-05-01', '2010-06-01');

INSERT INTO GENERO_FILME VALUES (200, 30);
INSERT INTO GENERO_FILME VALUES (100, 10);
INSERT INTO GENERO_FILME VALUES (300, 20);

INSERT INTO LISTA_DESEJO VALUES (100, 1);
INSERT INTO LISTA_DESEJO VALUES (300, 2);
INSERT INTO LISTA_DESEJO VALUES (200, 3);

INSERT INTO HISTORICO VALUES (1, 300);
INSERT INTO HISTORICO VALUES (2, 100);
INSERT INTO HISTORICO VALUES (3, 200);

INSERT INTO AVALIACAO_FILME VALUES (1,'Bom', 300, 7, '2019-10-05');
INSERT INTO AVALIACAO_FILME VALUES (2,'Merece Oscar', 100, 8, '2019-05-20');
INSERT INTO AVALIACAO_FILME VALUES (3,'Mediano', 200, 5, '2019-11-05');


INSERT INTO CLASSIFICACAO VALUES (1000, 10, 100);
INSERT INTO CLASSIFICACAO VALUES (2000, 18, 200);
INSERT INTO CLASSIFICACAO VALUES (3000, 'LIVRE', 300);

INSERT INTO CIDADE VALUES (500, 'Araraquara');
INSERT INTO CIDADE VALUES (600, 'São Paulo');
INSERT INTO CIDADE VALUES (700, 'Rio de Janeiro');

INSERT INTO CINEMA VALUES (40, 'Araraquara', 500);
INSERT INTO CINEMA VALUES (50, 'São Paulo', 600);
INSERT INTO CINEMA VALUES (60, 'Rio de Janeiro', 700);


INSERT INTO SESSAO VALUES (700,'ingresso.com.br', '19:00:00', 60);
INSERT INTO SESSAO VALUES (701,'moviecomingresso.com.br', '15:00:00', 50);
INSERT INTO SESSAO VALUES (702,'cinemaxingresso.com.br', '21:30:00', 40);





select * 
from filme, genero_filme, genero, diretor, ator
WHERE filme.id_filme = genero_filme.id_filme
and genero_filme.id_genero = genero.id_genero
and filme.id_diretor = diretor.id_diretor
and filme.id_ator = ator.id_ator
and titulo like 'CORINGA%';


select * 
from USUARIOS;


